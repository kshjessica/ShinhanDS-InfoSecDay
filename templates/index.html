<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>정보보호 점검</title>
</head>
<body>
<h2>정보보호의 날 점검</h2>

<form method="post" enctype="multipart/form-data">
점검일:
<input type="date" name="inspect_date" required><br><br>

점검자:
<input name="inspector" required><br><br>

성명:
<select name="name" id="name" required>
<option value="">선택</option>
{% for u in users %}
<option value="{{u[0]}}">{{u[0]}}</option>
{% endfor %}
</select><br><br>

부서: <input name="department" id="department" readonly><br>
자산번호: <input name="asset_no" id="asset_no" readonly><br>
스티커번호: <input name="sticker_no" id="sticker_no"><br><br>

<hr>

{% for i in range(1,6) %}
항목 {{i}}:
<select name="item{{i}}">
  <option value="1">정상</option>
  <option value="0">미흡</option>
</select><br>
{% endfor %}

<br>
사진 첨부:
<input type="file" name="photo"><br><br>

코멘트:
<textarea name="comment"></textarea><br><br>

<button type="submit" name="status" value="temp">임시저장</button>
<button type="submit" name="status" value="submitted">제출</button>
</form>

<script>
document.getElementById("name").addEventListener("change", function(){
    fetch("/get_user?name=" + this.value)
    .then(res => res.json())
    .then(data => {
        department.value = data.department || "";
        asset_no.value = data.asset_no || "";
        sticker_no.value = data.sticker_no || "";
    });
});
</script>

</body>
</html>
